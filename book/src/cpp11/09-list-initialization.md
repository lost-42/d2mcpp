<div align=right>

  ğŸŒ [ä¸­æ–‡] | [English]
</div>

[ä¸­æ–‡]: ./09-list-initialization.html
[English]: ../en/cpp11/09-list-initialization.html

# åˆ—è¡¨åˆå§‹åŒ–

åˆ—è¡¨åˆå§‹æ˜¯ä¸€ç§ç”¨`{ arg1, arg2, ... }`åˆ—è¡¨(å¤§æ‹¬å·), åˆå§‹åŒ–å¯¹è±¡çš„ä¸€ç§åˆå§‹åŒ–é£æ ¼, å¹¶ä¸”å¯ä»¥ç”¨äºå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡åˆå§‹åŒ–åœºæ™¯, æ‰€ä»¥ä¹Ÿå¸¸å¸¸ç§°ä»–ä¸º**ç»Ÿä¸€åˆå§‹åŒ–**ã€‚æ­¤å¤–, ä»–è¿˜å¢åŠ äº†åˆ—è¡¨æˆå‘˜çš„ç±»å‹æ£€æŸ¥åŠŸèƒ½, é˜²æ­¢ä¸€äº›çª„åŒ–é—®é¢˜

| Book | Video | Code | X | 
| --- | --- | --- | --- |
| [cppreference](https://en.cppreference.com/w/cpp/language/list_initialization.html) / [markdown](https://github.com/mcpp-community/d2mcpp/blob/main/book/src/cpp11/09-list-initialization.md) | [è§†é¢‘è§£è¯»](https://www.bilibili.com/video/BV1vKuQzkEo2) | [ç»ƒä¹ ä»£ç ](https://github.com/mcpp-community/d2mcpp/blob/main/dslings/cpp11/09-list-initialization-0.cpp) |  |

**ä¸ºä»€ä¹ˆå¼•å…¥?**

- è§£å†³åˆå§‹åŒ–è¯­æ³•é£æ ¼ä¸ç»Ÿä¸€é—®é¢˜
- ç¦æ­¢éšå¼è½¬æ¢é€ æˆçš„çª„åŒ–é—®é¢˜
- æ–¹ä¾¿å®¹å™¨ç±»å‹çš„åˆå§‹åŒ–
- è§£å†³é»˜è®¤åˆå§‹åŒ–è¯­æ³•é™·é˜±

## ä¸€ã€åŸºç¡€ç”¨æ³•å’Œåœºæ™¯

### ç»Ÿä¸€åˆå§‹åŒ–é£æ ¼

c++11ä¹‹å‰ä¸åŒåœºæ™¯æœ‰ä¸åŒçš„åˆå§‹åŒ–çš„æ–¹å¼

```cpp
int a = 5;              // æ‹·è´åˆå§‹åŒ–
int b(5);               // ç›´æ¥åˆå§‹åŒ–
int arr[3] = {1, 2, 3}; // æ•°ç»„åˆå§‹åŒ–
Object obj1;            // é»˜è®¤æ„é€ 
Object obj2(obj1);      // æ‹·è´æ„é€ 
```

ä»–ä»¬å¯ä»¥ç”¨`{ }`è¿›è¡Œé£æ ¼ç»Ÿä¸€

```cpp
int a = { 5 };              // æ‹·è´åˆå§‹åŒ–
int b { 5 };                // ç›´æ¥åˆå§‹åŒ–
int arr[3] = {1, 2, 3};     // æ•°ç»„åˆå§‹åŒ–
Object obj1 { };            // é»˜è®¤åˆå§‹åŒ–
Object obj2 { obj1 };       // æ‹·è´æ„é€ 
```

### é¿å…éšå¼ç±»å‹è½¬æ¢å’Œçª„åŒ–é—®é¢˜

ä¸€èˆ¬ä¼ ç»Ÿçš„åˆå§‹åŒ–æ–¹æ³•, æ˜¯é»˜è®¤Cè¯­è¨€éšå¼ç±»å‹è½¬æ¢è§„åˆ™é£æ ¼. ä¾‹å¦‚, ç”¨`double`ç±»å‹åˆå§‹åŒ–`int`ç±»å‹å˜é‡çš„æ—¶å€™ä¼šè‡ªåŠ¨ä¸¢æ‰å°æ•°ä½. è€Œåˆ—è¡¨åˆå§‹åŒ–ä¼šå¢åŠ é¢å¤–çš„ç¼–è¯‘æœŸç±»å‹æ£€æŸ¥æ¥é¿å…éšå¼ç±»å‹è½¬æ¢å’Œç²¾åº¦ä¸¢å¤±é—®é¢˜. åœ¨ç°ä»£C++ä¸­, é™¤éæœ‰æ„çš„éœ€è¦è¿™ç§éšå¼ç±»å‹è½¬æ¢, å¤§å¤šæ•°æ—¶å€™ä½¿ç”¨åˆ—è¡¨åˆå§‹åŒ–æ˜¯æ›´å¥½çš„é€‰æ‹©

```cpp
int a = 3.3; // ok
int a = { 3.3 }; // error

constexpr double b { 3.3 }; // ok
int c(b); // ok -> 3
int c { b }; // error: ç±»å‹ä¸åŒ¹é…
```

æ•°ç»„åˆå§‹åŒ–ä¸­çš„çª„åŒ–æ£€æŸ¥

```cpp
int arr[] { 1, 2, 3.3, 4 }; // error: 3.3ä¼šå‘ç”Ÿçª„åŒ–
int arr[] = { 1, 2, b, 4 }; // error: bä¼šå‘ç”Ÿçª„åŒ–
```

> æ³¨: å¦‚æœbæ˜¯è¿è¡Œæ—¶å˜é‡, ç¼–è¯‘æœŸå¯èƒ½åªä¼šè§¦å‘çª„åŒ–è­¦å‘Šè€Œä¸ä¼šæŠ¥é”™

### æé«˜å®¹å™¨åˆå§‹åŒ–çš„ç®€æ´æ€§

å¯¹äºå®¹å™¨ç±»å‹çš„åˆå§‹åŒ–, è€C++ä¸­å¸¸å¸¸ä¼šåˆ†æˆä¸¤ä¸ªæ­¥éª¤ã€‚ç¬¬ä¸€æ­¥, åˆ›å»ºä¸€ä¸ªå…ƒç´ æ•°ç»„; ç¬¬äºŒæ­¥, ä½¿ç”¨è¿™ä¸ªæ•°ç»„æ¥åˆå§‹åŒ–å®¹å™¨

```cpp
int arr[5] = {1, 2, 3, 4, 5};
std::vector<int> v(arr, arr + sizeof(arr) / sizeof(int));
```

è€Œåˆ—è¡¨åˆå§‹åŒ–çš„å¼•å…¥, èƒ½è®©æˆ‘ä»¬æŠŠä¸¤æ­¥åˆä¸ºä¸€ä¸ªæ­¥éª¤, å¤§å¹…åº¦æé«˜äº†å®¹å™¨åˆå§‹åŒ–çš„ç®€æ´æ€§

```cpp
std::vector<int> v1 {1, 2, 3};
std::vector<int> v2 {1, 2, 3, 4, 3};
```

å¹¶ä¸”, å¯ä»¥é€šè¿‡`std::initializer_list`è®©æˆ‘ä»¬çš„è‡ªå®šä¹‰ç±»å‹ä¹Ÿèƒ½æ”¯æŒè¿™ç§**ä¸å®šé•¿**çš„åˆ—è¡¨åˆå§‹åŒ–æ–¹å¼

```cpp
class MyVector {
public:
    MyVector() = default;
    MyVector(std::initializer_list<int> list) {
        for (auto it = list.begin(); it != list.end(); it++) {
            // *it ...
        }
    }
};
```

```cpp
MyVector v1 {1, 2, 3};
MyVector v2 {1, 2, 3, 4, 3};
```

### é¿å…åˆå§‹åŒ–è¯­æ³•é™·é˜±

ä½¿ç”¨`{ }`è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°, é¿å…è¯­æ³•é™·é˜±

```cpp
#include <iostream>

struct Object {
    Object() { std::cout << "Constructor called!" << std::endl; }
};

int main() {
    Object obj1 { };
    Object obj2(); // obj2æ˜¯å‡½æ•°, è€Œä¸æ˜¯Objectå¯¹è±¡
}
```

## äºŒã€æ³¨æ„äº‹é¡¹

### æ•°ç»„ç±»å‹åˆ—è¡¨åˆå§‹åŒ–

æ•°ç»„ç±»å‹çš„å®šä¹‰é‡Œé¢çš„å€¼ä¸€èˆ¬æ˜¯ä¸ç¡®å®šçš„, ä½†æ˜¯åˆ—è¡¨åˆå§‹åŒ–çš„æ–¹å¼ä¼šåšé»˜è®¤å€¼çš„åˆå§‹åŒ–, å¹¶æ”¯æŒè‡ªåŠ¨è¡¥0

æ™®é€šæ•°ç»„

```cpp
int arr[4];          // arr[0] ä¸ç¡®å®š
int arr[4] { };      // arr[0] = 0
int arr[4] { 1, 2 }; // arr[2] / arr[3] ä¼šè‡ªåŠ¨è¡¥æˆ0
```

æ•°ç»„å®¹å™¨

```cpp
std::array<int, 4> arr;     // arr[0] ä¸ç¡®å®š/å¯èƒ½æ˜¯éšæœºå€¼
std::array<int, 4> arr { }; // arr[0] == 0
std::array<int, 4> arr { 1, 2 }; // arr[0] == 1, arr[2] ä¼šè‡ªåŠ¨è¡¥æˆ0
```

### æˆå‘˜åˆå§‹åŒ–é—®é¢˜

åˆ—è¡¨åˆå§‹åŒ–æ”¯æŒç›´æ¥å¯¹ èšåˆç±»å‹çš„æˆå‘˜åšåˆå§‹åŒ–, ä½†éœ€è¦æ³¨æ„æ·»åŠ æ„é€ å‡½æ•°åå¿…é¡»è¦åŒ¹é…æ„é€ å‡½æ•°æ‰å¯ä»¥

```cpp
struct Point {
    int x, y;
    // Point(int x, int y) { ... }
};
```

```cpp
Point { 1, 2 };
Point p1 { 2, 3 }; // p1 { x: 2, y: 3}
```

### ä¼˜å…ˆåŒ¹é…`std::initializer_list`çš„æ„é€ å‡½æ•°

```cpp
class MyVector {
public:
    MyVector() = default;
    MyVector(int x, int y) {  }
    MyVector(std::initializer_list<int> list) {
        for (auto it = list.begin(); it != list.end(); it++) {
            // *it ...
        }
    }
};
```

```cpp
MyVector v1 { 1, 2 }; // ä¼šä¼˜å…ˆåŒ¹é… MyVector(std::initializer_list<int> list)
MyVector v1(1, 2); // åŒ¹é…MyVector(int x, int y)
```

## ä¸‰ã€å…¶ä»–

- [äº¤æµè®¨è®º](https://forum.d2learn.org/category/20)
- [d2mcppæ•™ç¨‹ä»“åº“](https://github.com/mcpp-community/d2mcpp)
- [æ•™ç¨‹è§†é¢‘åˆ—è¡¨](https://space.bilibili.com/65858958/lists/5208246)
- [æ•™ç¨‹æ”¯æŒå·¥å…·-xlings](https://github.com/d2learn/xlings)